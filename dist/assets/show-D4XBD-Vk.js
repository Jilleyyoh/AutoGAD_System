import{u as b,r as i,j as e,H as g,L as u,a as h}from"./app-DZrL6wO1.js";import{A as f,s as n}from"./app-layout-BVNqvqA6.js";import{c as r,t as a}from"./theme-classes-C1o5LvBg.js";import{C as y}from"./chevron-left-DLBjlG0X.js";import{S as j}from"./send-CrFCt5kN.js";import"./app-CSLFruQT.js";import"./utils-CNSwpjVw.js";import"./button-Cr4sDpjN.js";import"./index-hSTZO9jP.js";import"./index-D4D1kMjY.js";import"./index-CYBwx7kR.js";import"./x-FRcdCJN5.js";import"./createLucideIcon-DkMGSA4v.js";import"./index-BNxELNJL.js";function z(){const{conversation:t,userRole:v}=b().props,[d,p]=i.useState(t.messages),[o,c]=i.useState(""),[l,m]=i.useState(!1),x=async()=>{if(o.trim()){m(!0);try{console.log("Sending message:",o),console.log("Route:",n("proponent.conversations.messages.store",t.id));const s=await h.post(n("proponent.conversations.messages.store",t.id),{message:o,subject:t.subject});console.log("Message sent successfully:",s.data),p([...d,s.data.data]),c("")}catch(s){console.error("Error sending message:",s),console.error("Error response:",s.response?.data),alert("Failed to send message: "+(s.response?.data?.message||s.message))}finally{m(!1)}}};return e.jsxs(f,{breadcrumbs:[{title:"Dashboard",href:n("proponent.dashboard")},{title:"Messages",href:n("proponent.conversations.index")},{title:t.subject||"Conversation",href:"#"}],children:[e.jsx(g,{title:t.subject||"Message"}),e.jsxs("div",{className:"max-w-2xl mx-auto py-6 px-4 sm:px-6 lg:px-8 h-screen flex flex-col",children:[e.jsxs("div",{className:r("border-b pb-4 mb-4",a.border.primary),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{href:n("proponent.conversations.index"),children:e.jsx(y,{className:"w-5 h-5"})}),e.jsx("h1",{className:r("text-2xl font-bold",a.text.primary),children:t.subject||"Conversation"})]}),e.jsxs("p",{className:r("text-sm",a.text.secondary),children:["Started ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsx("div",{className:r("flex-1 overflow-y-auto space-y-4 mb-4 pr-2",""),children:d.map(s=>e.jsxs("div",{className:r("p-4 rounded-lg",s.replied_by?"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-slate-700/50 border border-gray-200 dark:border-slate-600"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:r("font-semibold text-sm",s.replied_by?"text-blue-900 dark:text-blue-100":a.text.primary),children:s.replied_by?"Admin Response":"Your Message"}),e.jsx("time",{className:r("text-xs",a.text.tertiary),children:new Date(s.created_at).toLocaleString()})]}),e.jsx("p",{className:r("whitespace-pre-wrap break-words",a.text.primary),children:s.message})]},s.id))}),e.jsx("div",{className:r("border-t pt-4",a.border.primary),children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:o,onChange:s=>c(s.target.value),placeholder:"Type your message...",rows:3,className:r("flex-1 p-3 border rounded-lg resize-none",a.border.primary,a.text.primary)}),e.jsxs("button",{onClick:x,disabled:l||!o.trim(),className:r("px-4 py-3 rounded-lg font-medium flex items-center gap-2 self-end",l||!o.trim()?"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed":a.button.primary),children:[e.jsx(j,{className:"w-4 h-4"}),l?"Sending...":"Send"]})]})})]})]})}export{z as default};

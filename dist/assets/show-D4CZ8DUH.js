import{r as x,j as e,H as P,a as A}from"./app-DZrL6wO1.js";import{A as I,s as b,a as j}from"./app-layout-BVNqvqA6.js";import{c as s,t}from"./theme-classes-C1o5LvBg.js";import{C as u,V as R}from"./version-info-pquDlwvR.js";import{C as E}from"./chevron-left-DLBjlG0X.js";import{C as q}from"./circle-alert-A2Xx533H.js";import{F as C}from"./file-text-BtWhND71.js";import{D as S}from"./download-mUmP9tzt.js";import{L as B}from"./loader-BlIxAh7e.js";import"./app-CSLFruQT.js";import"./utils-CNSwpjVw.js";import"./button-Cr4sDpjN.js";import"./index-hSTZO9jP.js";import"./index-D4D1kMjY.js";import"./index-CYBwx7kR.js";import"./x-FRcdCJN5.js";import"./createLucideIcon-DkMGSA4v.js";import"./index-BNxELNJL.js";import"./clock-uWUX0Jnj.js";function de({project:a,evaluations:_,average_score:l,evaluation_count:F,interpretation:z,interpretations:f,documents:p,certificate:m}){const[c,g]=x.useState(!1),[y,N]=x.useState(""),[D,h]=x.useState(!1),[w,v]=x.useState(null),[T,L]=x.useState(!1),V=async r=>{r.preventDefault(),v(null),g(!0);try{const i=await A.post(b("admin2.certifications.generate",a.id),{confirmation_remarks:y});L(!0),N(""),h(!1),setTimeout(()=>{window.location.reload()},2e3)}catch(i){v(i.response?.data?.message||"Failed to generate certificate")}finally{g(!1)}},$=r=>r?f.find(o=>r>=o.min&&r<=o.max)?.interpretation||"Unknown":"Pending",n=r=>r==null?{bg:"from-gray-50 to-gray-100",border:"border-gray-200",textLabel:"text-gray-600",textValue:"text-gray-900",textSecondary:"text-gray-700",textTertiary:"text-gray-600",icon:"text-gray-600"}:r>=15?{bg:"from-green-50 to-green-100",border:"border-green-200",textLabel:"text-green-600",textValue:"text-green-900",textSecondary:"text-green-700",textTertiary:"text-green-600",icon:"text-green-600"}:r>=8?{bg:"from-blue-50 to-blue-100",border:"border-blue-200",textLabel:"text-blue-600",textValue:"text-blue-900",textSecondary:"text-blue-700",textTertiary:"text-blue-600",icon:"text-blue-600"}:r>=4?{bg:"from-yellow-50 to-yellow-100",border:"border-yellow-200",textLabel:"text-yellow-600",textValue:"text-yellow-900",textSecondary:"text-yellow-700",textTertiary:"text-yellow-600",icon:"text-yellow-600"}:{bg:"from-red-50 to-red-100",border:"border-red-200",textLabel:"text-red-600",textValue:"text-red-900",textSecondary:"text-red-700",textTertiary:"text-red-600",icon:"text-red-600"},k=m!==null;return e.jsxs(I,{children:[e.jsx(P,{title:`Certification - ${a.project_code}`}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("a",{href:b("admin2.certifications.index"),className:s("flex items-center gap-2 mb-4 transition-colors",t.link.primary),children:[e.jsx(E,{className:"w-5 h-5"}),"Back to Certifications"]}),e.jsxs("h1",{className:s("text-3xl font-bold flex items-center gap-3",t.text.primary),children:[e.jsx(j,{className:"w-8 h-8 text-blue-600"}),"Certification Details"]})]}),k&&e.jsxs("div",{className:s("mb-6 p-4 border rounded-lg flex items-start gap-3",t.alert.success),children:[e.jsx(u,{className:"w-6 h-6 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 dark:text-green-100",children:"Project Certified"}),e.jsxs("p",{className:"text-green-700 dark:text-green-200 text-sm",children:["Certificate #",m.certificate_number," issued on ",m.issued_date," by ",m.issued_by]})]})]}),T&&e.jsx("div",{className:s("mb-6 p-4 border rounded-lg",t.alert.success),children:e.jsx("p",{className:"text-green-700 dark:text-green-200 font-medium",children:"✓ Certificate generated successfully!"})}),w&&e.jsxs("div",{className:s("mb-6 p-4 border rounded-lg flex items-start gap-3",t.alert.error),children:[e.jsx(q,{className:"w-6 h-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 dark:text-red-100",children:"Error"}),e.jsx("p",{className:"text-red-700 dark:text-red-200 text-sm",children:w})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:s("rounded-lg shadow p-6",t.card.base),children:[e.jsxs("h2",{className:s("text-lg font-semibold mb-4 flex items-center gap-2",t.text.primary),children:[e.jsx(C,{className:"w-5 h-5 text-blue-600"}),"Project Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Project Code"}),e.jsx("p",{className:s("text-base font-medium px-3 py-2 rounded",t.text.primary,t.input.base),children:a.project_code})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Status"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.status})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Title"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.title})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Description"}),e.jsx("p",{className:s("text-sm p-3 rounded",t.text.secondary,t.input.base),children:a.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Organization"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.organization})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Domain"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.domain})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Implementation Phase"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.phase})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Submission Date"}),e.jsx("p",{className:s("text-base font-medium",t.text.primary),children:a.submission_date})]})]})]})]}),e.jsx("div",{className:`bg-gradient-to-r ${n(l).bg} border ${n(l).border} rounded-lg p-8 mb-8`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${n(l).textLabel} uppercase tracking-wide`,children:"Consolidated Average Score"}),e.jsx("p",{className:`text-5xl font-bold ${n(l).textValue} mt-2`,children:l?.toFixed(2)||"N/A"}),e.jsx("p",{className:`text-lg ${n(l).textSecondary} mt-2 font-semibold`,children:$(l||void 0)}),e.jsxs("p",{className:`text-sm ${n(l).textTertiary} mt-1`,children:["Based on ",F," completed evaluation(s)"]})]}),e.jsx(u,{className:`w-16 h-16 ${n(l).icon}`})]})}),e.jsx("div",{className:"space-y-6 mb-8",children:_.map(r=>e.jsxs("div",{className:s("rounded-lg shadow p-6",t.card.base),children:[e.jsxs("div",{className:"flex items-start justify-between mb-6 pb-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h3",{className:s("text-lg font-semibold",t.text.primary),children:r.evaluator_name}),e.jsx("p",{className:s("text-sm",t.text.secondary),children:r.evaluator_email}),e.jsxs("p",{className:s("text-xs mt-1",t.text.tertiary),children:["Submitted: ",r.completion_date]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-3xl font-bold ${n(r.total_score).textValue}`,children:r.total_score?.toFixed(2)}),e.jsx("p",{className:`text-sm ${n(r.total_score).textTertiary} mt-1`,children:r.interpretation})]})]}),r.questionnaire_version&&e.jsx("div",{className:"mb-6 pb-6 border-b",children:e.jsx(R,{version:r.questionnaire_version,compact:!0})}),e.jsx("div",{className:"space-y-4 mb-4",children:r.scores_by_category.map((i,o)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:s("font-semibold",t.text.primary),children:i.category_name}),e.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:i.subtotal.toFixed(2)})]}),e.jsx("div",{className:"space-y-2",children:i.items.map((d,G)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:s("",t.text.secondary),children:d.question}),e.jsx("span",{className:s("font-medium",t.text.primary),children:d.score})]},G))}),i.items.some(d=>d.remarks)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:s("text-xs font-medium mb-1",t.text.tertiary),children:"Remarks:"}),e.jsx("p",{className:s("text-sm italic",t.text.secondary),children:i.items.filter(d=>d.remarks).map(d=>d.remarks).join(" | ")})]})]},o))}),r.final_remarks&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 rounded p-4",children:[e.jsx("p",{className:s("text-sm font-medium mb-1",t.text.primary),children:"Final Remarks"}),e.jsx("p",{className:s("text-sm",t.text.secondary),children:r.final_remarks})]})]},r.id))}),e.jsxs("div",{className:s("rounded-lg shadow p-6 mb-8",t.card.base),children:[e.jsx("h3",{className:s("text-lg font-semibold mb-4",t.text.primary),children:"Score Interpretation Reference"}),e.jsx("div",{className:"space-y-2",children:f.map((r,i)=>e.jsxs("div",{className:s("flex items-center justify-between p-3 rounded-lg",t.table.row),children:[e.jsxs("div",{children:[e.jsx("p",{className:s("font-medium",t.text.primary),children:r.interpretation}),r.description&&e.jsx("p",{className:s("text-sm",t.text.secondary),children:r.description})]}),e.jsxs("span",{className:s("text-sm font-bold px-3 py-1 rounded",t.text.primary,t.badge.blue),children:[r.min.toFixed(0)," - ",r.max.toFixed(0)]})]},i))})]}),p.length>0&&e.jsxs("div",{className:s("rounded-lg shadow p-6",t.card.base),children:[e.jsxs("h2",{className:s("text-lg font-semibold mb-4 flex items-center gap-2",t.text.primary),children:[e.jsx(C,{className:"w-5 h-5 text-green-600"}),"Project Documents (",p.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.map(r=>e.jsxs("div",{className:s("flex items-center justify-between p-3 border rounded-lg transition-colors",t.table.row,t.border.primary),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:s("font-medium",t.text.primary),children:r.file_name}),e.jsxs("p",{className:s("text-xs",t.text.tertiary),children:[r.document_type," • Uploaded: ",r.upload_date]}),r.description&&e.jsx("p",{className:s("text-sm mt-1",t.text.secondary),children:r.description})]}),e.jsx("div",{className:"flex gap-2 ml-4",children:r.drive_link&&e.jsx("a",{href:r.drive_link,target:"_blank",rel:"noopener noreferrer",className:s("transition-colors",t.link.primary),title:"View on Google Drive",children:e.jsx(S,{className:"w-5 h-5"})})})]},r.id))})]})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:s("rounded-lg shadow p-6 sticky top-8",t.card.base),children:[e.jsxs("h2",{className:s("text-lg font-semibold mb-4 flex items-center gap-2",t.text.primary),children:[e.jsx(j,{className:"w-5 h-5 text-blue-600"}),"Certification"]}),k?e.jsxs("div",{children:[e.jsxs("div",{className:s("mb-6 p-4 border rounded-lg",t.alert.success),children:[e.jsx("p",{className:s("text-sm font-medium mb-1",t.text.primary),children:"Status"}),e.jsx("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:"Certified"}),e.jsxs("p",{className:"text-xs text-green-700 dark:text-green-200 mt-2",children:["Certificate #",m.certificate_number]})]}),e.jsxs("a",{href:b("admin2.certifications.download",m.id),target:"_blank",rel:"noopener noreferrer",className:s("w-full font-semibold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors mb-3",t.button.primary),children:[e.jsx(S,{className:"w-5 h-5"}),"Download Certificate PDF"]}),e.jsxs("p",{className:s("text-xs text-center",t.text.tertiary),children:["Issued on ",m.issued_date]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:s("mb-4 p-4 border rounded-lg",t.alert.info),children:[e.jsx("p",{className:s("text-sm font-medium mb-1",t.text.primary),children:"Status"}),e.jsx("p",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:"Pending"}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-200 mt-2",children:"Ready to issue certificate"})]}),D?e.jsxs("form",{onSubmit:V,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:s("block text-sm font-medium mb-2",t.text.primary),children:"Additional Remarks (Optional)"}),e.jsx("textarea",{value:y,onChange:r=>N(r.target.value),placeholder:"Add any remarks about this certification...",rows:3,className:s("w-full px-3 py-2 rounded-lg text-sm",t.input.base,t.input.focus,t.input.placeholder)})]}),e.jsx("button",{type:"submit",disabled:c,className:s("w-full font-semibold py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors disabled:cursor-not-allowed",c?"bg-gray-400 dark:bg-gray-600 text-white cursor-not-allowed":"bg-green-600 hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-500 text-white"),children:c?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"w-4 h-4"}),"Confirm & Generate"]})}),e.jsx("button",{type:"button",onClick:()=>h(!1),disabled:c,className:s("w-full font-semibold py-2 px-4 rounded-lg transition-colors disabled:cursor-not-allowed",t.button.secondary),children:"Cancel"})]}):e.jsxs("button",{onClick:()=>h(!0),className:s("w-full font-semibold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors",t.button.primary),children:[e.jsx(j,{className:"w-5 h-5"}),"Generate Certificate"]})]})]}),e.jsxs("div",{className:s("rounded-lg shadow p-6 mt-6",t.card.base),children:[e.jsx("h3",{className:s("text-sm font-semibold mb-3",t.text.primary),children:"Proponent Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:s("text-xs",t.text.tertiary),children:"Name"}),e.jsx("p",{className:s("text-sm font-medium",t.text.primary),children:a.proponent_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-xs",t.text.tertiary),children:"Email"}),e.jsx("p",{className:s("text-sm break-all",t.link.primary),children:a.proponent_email})]})]})]})]})]})]})})]})}export{de as default};
